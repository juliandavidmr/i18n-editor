<app-sidenav>
  <div class="editor-component">

    <h1>Welcome to i18n-editor!</h1>

    <button type="button" mat-raised-button (click)="imgFileInput.click()">Add a resources</button>
    <input hidden type="file" #imgFileInput (change)="readMultiFiles($event)" multiple/>
    &nbsp;&nbsp;
    <button (click)="save()" mat-raised-button [disabled]="!rw.hasFiles">Download</button>
    <br><br>
    <br>

    <div *ngIf="rw.hasFiles" class="editor-component_info">
      <div class="editor-component_info__item">
        {{ rw.fileList.length }} files
      </div>
      <div class="editor-component_info__item">
        {{ rw.categoryList.length }} resources
      </div>
    </div>

    <div>
      <div *ngIf="rw.hasFiles">
        <mat-form-field>
          <input matInput [placeholder]="'Add new translation key'" [(ngModel)]="modelNewKey"/>
        </mat-form-field>
        <button mat-button (click)="addNewKey()">Add</button>
      </div>

      <br>

      <mat-accordion>
        <ng-container *ngFor="let c of rw.categoryList; trackBy: trackCategoryByKey; let i = index;">
          <mat-expansion-panel hideToggle="true">
            <mat-expansion-panel-header>
              <mat-panel-title>
                <span>#{{ i + 1 }}. {{ c.keyName }}</span>
              </mat-panel-title>
              <mat-panel-description>
                <span>{{ c.languages.length }} elements</span>
              </mat-panel-description>
            </mat-expansion-panel-header>
            <ng-template matExpansionPanelContent>
              <ng-container *ngFor="let transl of c.languages; trackBy: trackResourceByKey">
                <div class="editor-component_input">
                  <label>{{ transl.lang }}</label>
                  <input [placeholder]="transl.lang" [(ngModel)]="transl.text"/>
                </div>
                <div *ngIf="states[i].inner" class="editor-component_states--inner">
                  <div [innerHTML]="transl.text"></div>
                </div>
              </ng-container>

              <div *ngIf="states.length > 0" class="editor-component_footer">
                <mat-form-field matLine>
                  <input matInput [placeholder]="'Enter filename for new language'"
                         [(ngModel)]="modelNewLanguage"/>
                </mat-form-field>
                <button mat-button (click)="addLanguage(false, c.keyName)">Add only to this resource</button>
                <button mat-button (click)="addLanguage(true, c.keyName)">Add to all resources</button>
                <div>
                  <button mat-button [matMenuTriggerFor]="animals">Options</button>
                  <mat-menu #animals="matMenu">
                    <button mat-menu-item [matMenuTriggerFor]="render">Render</button>
                    <button mat-menu-item [matMenuTriggerFor]="format">Format</button>
                    <button mat-menu-item (click)="rw.removeResourceKey(c.keyName)">Remove this key</button>
                  </mat-menu>
                  <mat-menu #render="matMenu">
                    <button mat-menu-item>
                      <mat-checkbox (change)="onChangeInner($event, i)" title="Render HTML content in each translation">
                        Render
                      </mat-checkbox>
                    </button>
                  </mat-menu>
                  <mat-menu #format="matMenu">
                    <button mat-menu-item (click)="copyFormat('ngx-translate', c.keyName)">ngx-translate format</button>
                  </mat-menu>
                </div>
              </div>
            </ng-template>
          </mat-expansion-panel>
        </ng-container>
      </mat-accordion>
    </div>
  </div>
</app-sidenav>
